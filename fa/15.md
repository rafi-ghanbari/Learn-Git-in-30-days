# روز ۱۵: تگ‌ها - علامت‌گذاری رویدادهای مهم در کنترل نسخه (Tags)

هنگام استفاده از گیت برای کنترل نسخه، تعداد زیادی از نسخه‌ها تولید خواهد شد. با گذشت زمان، در میان این نسخه‌های بسیار، قطعاً برخی نسخه‌های مهم وجود خواهند داشت که ارزش ثبت کردن دارند. این همان کاری است که "تگ‌ها" (tags) می‌توانند برای ما انجام دهند.

## درک تگ‌ها - مفاهیم پایه

اساساً، هدف از یک تگ، علامت‌گذاری یک "نسخه" یا "شیء کامیت" خاص با یک "نامِ آسان برای یادآوری" است تا به ما کمک کند یک نسخه خاص را به خاطر بسپاریم.

تگ مرجعی است که به یک کامیت خاص در تاریخچه گیت شما اشاره می‌کند. برخلاف شاخه‌ها (branches)، تگ‌ها زمانی که کامیت‌های جدیدی انجام می‌دهید حرکت نمی‌کنند - آن‌ها همیشه به همان کامیت اشاره دارند. این موضوع تگ‌ها را برای علامت‌گذاری نقاط انتشار (release) یا سایر نقاط عطف مهم ایده آل می‌کند.

گیت از دو نوع تگ پشتیبانی می‌کند:

۱. **تگ‌های سبک (Lightweight tags)**: به سادگی یک نام (نام مستعار) برای یک کامیت خاص هستند - نوعی "نام مرجع" محسوب می‌شوند.
۲. **تگ‌های حاشیه‌نویسی شده (Annotated tags)**: به عنوان اشیاء کامل گیت با متادیتای اضافی ذخیره می‌شوند.

همانطور که در روز ۱۱ (درک مراجع شیء Git) ذکر شد، "مراجع عمومی" شامل "نام‌های تگ" هستند و "نام تگ" در اینجا به "تگ‌های سبک" اشاره دارد. بنابراین می‌توان گفت "تگ‌های سبک" فقط یک "نام مستعار" برای یک نسخه کامیت خاص هستند که نوعی "نام نسبی" محسوب می‌شوند.

"تگ‌های حاشیه‌نویسی شده" نوعی شیء Git هستند. همانطور که در روز ۰۶ (تجزیه ساختار داده Git - ساختار اشیاء) ذکر شد، اشیاء Git شامل ۴ نوع شیء هستند: اشیاء Blob، Tree، Commit و Tag. "تگ حاشیه‌نویسی شده" که در اینجا ذکر شد، یک شیء Tag است. اشیاء Tag در بخش ذخیره‌سازی اشیاء Git (واقع در دایرکتوری `.git\objects\`) ذخیره می‌شوند و با یک شیء کامیت دیگر مرتبط هستند. هنگام ایجاد "تگ‌های حاشیه‌نویسی شده"، می‌توانید همانند زمانی که یک شیء کامیت ایجاد می‌کنید، "پیام‌های نسخه" را نیز درج کنید. در مکانیزم داخلی تگ گیت، حتی می‌توانید از کلیدهای GnuPG برای امضای اشیاء Tag استفاده کنید تا از "عدم انکار" (non-repudiation) پیام اطمینان حاصل کنید.

اگرچه ما این دو نوع تگ را داریم و هر دو شبیه "نام مستعار" برای اشیاء کامیت به نظر می‌رسند، اما استفاده از این دو تگ فقط تفاوت‌های اندکی دارد. در بیشتر موارد استفاده، ما از "تگ‌های حاشیه‌نویسی شده" برای ایجاد "اشیاء تگ" و ارائه "پیام‌های نسخه" استفاده می‌کنیم، زیرا این نوع "تگ" یک "شیء دائمی" در مخزن Git است. (اشیاء Git ذخیره شده در بخش ذخیره‌سازی اشیاء، تغییرناپذیر هستند؛ فقط ایندکس تغییر می‌کند.)

## ایجاد تگ‌های سبک (Creating Lightweight Tags)

ساده‌ترین راه برای ایجاد یک تگ:

```
git tag v1.0
```

این دستور یک تگ سبک به نام `v1.0` ایجاد می‌کند که به کامیت فعلی (HEAD) اشاره دارد.

برای تگ کردن یک کامیت خاص:

```
git tag v0.9 <commit-hash>
```

**توجه**: تمام فایل‌های زیر دایرکتوری `.git\refs\` "نام‌های مرجع" هستند.

استفاده پایه:
* لیست کردن تمام تگ‌ها: `git tag`
* ایجاد تگ سبک: `git tag [tagname]`
* حذف تگ سبک: `git tag [tagname] -d`

اگر می‌خواهید محتوای یک "تگ سبک" را ببینید، می‌توانید از `git cat-file -p [tagname]` استفاده کنید. اگر می‌خواهید نوع شیء "تگ سبک" را ببینید، از `git cat-file -t [tagname]` استفاده کنید.

**نکته مهم**: یک تگ سبک، یک شیء Git نیست. از موارد فوق، می‌توانید ببینید که نام تگ محتوای شیء کامیت را بازیابی می‌کند و نوع شیء پیدا شده توسط نام نیز یک شیء کامیت است.

## ایجاد تگ‌های حاشیه‌نویسی شده (Creating Annotated Tags)

تگ‌های حاشیه‌نویسی شده برای بیشتر موارد استفاده توصیه می‌شوند زیرا اطلاعات اضافی را ذخیره می‌کنند:

```
git tag -a v1.0 -m "Release version 1.0"
```

پرچم `-a` یک تگ حاشیه‌نویسی شده ایجاد می‌کند و `-m` پیام تگ را مشخص می‌کند.

تفاوت‌ها با تگ‌های سبک:
۱. هنگام اجرای `git tag` برای لیست کردن تمام تگ‌ها، همه تگ‌ها با هم مخلوط می‌شوند و شما نمی‌توانید نوع تگ را ببینید.
۲. ایجاد "تگ‌های حاشیه‌نویسی شده" نیاز به پارامتر `-a` دارد.
۳. ایجاد "تگ‌های حاشیه‌نویسی شده" باید شامل یک "پیام نسخه" باشد، دقیقاً مانند اجرای `git commit`؛ هر دو پارامتر `-m` را در اختیار دارند.

## لیست کردن تگ‌ها

برای دیدن تمام تگ‌ها در مخزن خود:

```
git tag
```

برای دیدن تگ‌هایی که با یک الگو مطابقت دارند:

```
git tag -l "v1.*"
```

## مشاهده اطلاعات تگ

برای یک تگ سبک:

```
git show v1.0
```

این دستور کامیتی را نشان می‌دهد که تگ به آن اشاره می‌کند.

برای یک تگ حاشیه‌نویسی شده:

```
git show v1.0
```

این دستور اطلاعات تگ را به اضافه جزئیات کامیت نشان می‌دهد.

## تگ کردن کامیت‌های قدیمی

می‌توانید کامیت‌هایی را که در HEAD نیستند تگ کنید:

```
git log --oneline  # هش کامیت را پیدا کنید
git tag -a v0.5 -m "Beta release" <commit-hash>
```

## Push کردن تگ‌ها به مخزن راه دور (Remote)

به طور پیش‌فرض، `git push` تگ‌ها را منتقل نمی‌کند. باید صراحتاً آن‌ها را Push کنید:

```
# Push کردن یک تگ خاص
git push origin v1.0

# Push کردن تمام تگ‌ها
git push origin --tags
```

## حذف تگ‌ها

برای حذف یک تگ محلی:

```
git tag -d v1.0
```

برای حذف یک تگ راه دور:

```
git push origin :refs/tags/v1.0
# یا
git push origin --delete v1.0
```

## Checkout کردن تگ‌ها

می‌توانید کد را در یک تگ خاص Checkout کنید:

```
git checkout v1.0
```

این کار شما را در وضعیت "detached HEAD" قرار می‌دهد. اگر می‌خواهید تغییراتی ایجاد کنید، یک شاخه جدید بسازید:

```
git checkout -b version-1-fixes v1.0
```

## خلاصه امروز

تگ‌ها بخش ضروری از کنترل نسخه هستند که به شما امکان می‌دهند نقاط مهم در تاریخچه پروژه خود را علامت‌گذاری کنید. تگ‌های حاشیه‌نویسی شده به ویژه برای انتشارها (releases) مفید هستند زیرا می‌توانند اطلاعات اضافی مانند یادداشت‌های انتشار، اطلاعات تگ‌کننده و امضاها را ذخیره کنند.

اجازه دهید دستورات گیت و پارامترهای یاد گرفته شده امروز را دوباره سازماندهی کنم:

* git tag
* git tag -a
* git tag -l
* git show
* git push origin --tags
* git tag -d
* git checkout

---

* [بازگشت به فهرست مطالب](README.md)
* [روز قبل: گزینه‌های پیکربندی Git for Windows](14.md)
* [روز بعد: استفاده از git reflog برای ردیابی تاریخچه تغییرات](16.md)

---
