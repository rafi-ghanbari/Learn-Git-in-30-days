# روز ۳۰: اشتراک‌گذاری نکات مفید کار با Git از تجربیات کاری

پس از ۲۹ روز یادگیری Git، این مقاله نهایی مجموعه‌ای از نکات کاربردی و ترفندهایی را به اشتراک می‌گذارد که عملیات روزانه Git را کارآمدتر و لذت‌بخش‌تر می‌کند.

## نکات مربوط به پیکربندی (Configuration)

### تنظیمات جهانی (Global)

```
# تنظیم ویرایشگر پیش‌فرض
git config --global core.editor "code --wait"

# فعال‌سازی رنگ در رابط کاربری
git config --global color.ui auto

# تنظیم نام شاخه پیش‌فرض
git config --global init.defaultBranch main

# اصلاح خودکار غلط‌های املایی
git config --global help.autocorrect 1

# کش کردن اطلاعات کاربری (Credentials)
git config --global credential.helper cache --timeout=3600
```

### نام‌های مستعار مفید (Aliases)

```
# وضعیت کوتاه
git config --global alias.st status

# لاگ کوتاه و رنگی
git config --global alias.ll "log --oneline --graph --all --decorate"

# آخرین کامیت
git config --global alias.last "log -1 HEAD"

# لغو آخرین کامیت (نگه داشتن تغییرات)
git config --global alias.undo "reset HEAD~1 --mixed"

# اصلاح (Amend) بدون ویرایش پیام
git config --global alias.amend "commit --amend --no-edit"

# لیست شاخه‌ها بر اساس تاریخ آخرین تغییر
git config --global alias.br "branch --sort=-committerdate"

# نمایش فایل‌های تغییر یافته در آخرین کامیت
git config --global alias.dl "diff --name-only HEAD~1"

# جستجو در پیام‌های کامیت
git config --global alias.search "log --all --grep"

# حذف اجباری شاخه
git config --global alias.nuke "branch -D"
```

## نکات افزایش بهره‌وری

### جابجایی سریع

```
# رفتن به ریشه مخزن (root)
alias gr='cd $(git rev-parse --show-toplevel)'

# باز کردن مخزن در مرورگر
alias browse='git remote get-url origin | xargs open'
```

### جستجو

```
# پیدا کردن فایل در کل تاریخچه
git log --all --full-history -- "**/filename.*"

# جستجو در تمام کامیت‌ها
git log -S "search term" --source --all

# پیدا کردن نویسنده یک خط خاص
git blame filename

# نمایش شکیل‌تر blame
git blame -w -C -C -L 10,20 filename
```

### پاکسازی

```
# حذف شاخه‌های ادغام شده با main
git branch --merged main | grep -v "^*\|main" | xargs git branch -d

# حذف تمام شاخه‌های محلی بجز main
git branch | grep -v "main" | xargs git branch -D

# حذف فایل‌های ردیابی نشده (ابتدا با -n تست کنید!)
git clean -n
git clean -fd

# پاکسازی شاخه‌های ردیابی راه دور منقضی شده
git fetch --prune
```

## دستورات صرفه‌جویی در زمان

### کامیت‌های سریع

```
# افزودن و کامیت در یک مرحله
git commit -am "اصلاح سریع"

# افزودن، کامیت و ارسال (Push)
alias gcp='git commit -am "$1" && git push'
```

### مدیریت شاخه

```
# ایجاد و رفتن به شاخه در یک مرحله
git checkout -b feature/new-feature

# بازگشت به شاخه قبلی
git checkout -

# نمایش شاخه‌ها همراه با آخرین کامیت
git branch -v

# نمایش شاخه‌های ردیابی راه دور
git branch -vv
```

### ترفندهای Stash

```
# Stash همراه با پیام توصیفی
git stash push -m "در حال کار روی قابلیت X"

# لیست کردن stashها با جزئیات
git stash list --pretty=format:"%C(yellow)%gd%C(reset) - %C(bold)%s%C(reset)"

# اعمال و حذف در یک مرحله (pop)
git stash pop

# اعمال یک stash خاص
git stash apply stash@{2}

# Stash شامل فایل‌های ردیابی نشده
git stash -u
```

## تکنیک‌های پیشرفته

### Cherry-Pick چندین کامیت

```
# انتخاب و اعمال محدوده‌ای از کامیت‌ها
git cherry-pick A^..B

# انتخاب از یک شاخه دیگر
git cherry-pick feature-branch~3..feature-branch
```

### آماده‌سازی تعابلی (Interactive Staging)

```
# آماده‌سازی بخش‌هایی از یک فایل
git add -p filename

# افزودن تعاملی
git add -i
```

### نکات مشاهده تفاوت‌ها (Diff)

```
# نمایش تفاوت کلمات به جای خطوط
git diff --word-diff

# نادیده گرفتن تغییرات فاصله‌های خالی (whitespace)
git diff -w

# نمایش تفاوت تغییرات آماده شده (staged)
git diff --staged

# تفاوت بین دو شاخه
git diff main..feature-branch

# تفاوت یک فایل خاص بین دو کامیت
git diff commit1 commit2 -- filename
```

### فرمت‌دهی گزارش (Log)

```
# گزارش شکیل
git log --pretty=format:"%C(yellow)%h%C(reset) - %C(green)(%cr)%C(reset) %s %C(blue)<%an>%C(reset)"

# گزارش همراه با نمودار
git log --graph --abbrev-commit --decorate --all

# نمایش فایل‌های تغییر یافته در هر کامیت
git log --stat

# نمایش وصله‌ها (patches)
git log -p
```

## عیب‌یابی (Troubleshooting)

### لغو اشتباهات

```
# لغو آخرین کامیت (نگه داشتن تغییرات در فایل‌ها)
git reset --soft HEAD~1

# لغو آخرین کامیت (پاک کردن تمام تغییرات)
git reset --hard HEAD~1

# لغو تمام تغییرات کامیت نشده
git checkout .

# خارج کردن فایل از حالت آماده (unstage)
git reset HEAD filename

# بازگرداندن فایل از آخرین وضعیت HEAD
git checkout HEAD -- filename
```

### بازیابی

```
# پیدا کردن کامیت‌های گم شده
git reflog

# بازیابی شاخه حذف شده
git branch branch-name <commit-hash>

# پیدا کردن کامیت‌های معلق
git fsck --lost-found
```

### عیب‌یابی (Debug)

```
# پیدا کردن کامیتی که باگ وارد کرده (جستجوی دودویی)
git bisect start
git bisect bad  # نسخه فعلی خراب است
git bisect good <commit>  # کامیت سالمی که می‌شناسید
# گیت کامیت میانی را انتخاب می‌کند
# تست کنید و به عنوان سالم یا خراب علامت بزنید
git bisect good/bad
# تکرار تا پیدا شدن کامیت مقصر
git bisect reset

# Blame با محدوده خطوط
git blame -L 10,20 filename

# نمایش کامیتی که کلمه خاصی را وارد کرده
git log -S "function name" --source --all
```

## بهینه‌سازی گردش کار

### Pre-Commit Hooks

ایجاد فایل `.git/hooks/pre-commit`:

```bash
#!/bin/bash

# اجرای تست‌ها قبل از هر کامیت
npm test
if [ $? -ne 0 ]; then
    echo "تست‌ها شکست خوردند، کامیت لغو شد"
    exit 1
fi
```

### قالب پیام کامیت

ایجاد فایل `~/.git-commit-template`:

```
# <type>: <subject>
#
# <body>
#
# <footer>
#
# Types: feat, fix, docs, style, refactor, test, chore
```

تنظیم به عنوان پیش‌فرض:

```
git config --global commit.template ~/.git-commit-template
```

## نکات ادغام و ابزارها

### Git همراه با VS Code

```
# باز کردن مخزن در VS Code
code .

# باز کردن ابزار ادغام تداخل‌ها
git mergetool --tool=vscode
```

### Git همراه با Vim

```
# تنظیم Vim به عنوان ویرایشگر پیش‌فرض
git config --global core.editor vim

# استفاده از Vim به عنوان ابزار مشاهده تفاوت‌ها
git config --global diff.tool vimdiff
git config --global difftool.prompt false
```

## نکات کارایی (Performance)

### مخازن حجیم

```
# کلون کم‌عمق (سریع‌تر، فقط آخرین تغییرات)
git clone --depth 1 https://github.com/user/repo.git

# کلون جزئی (گیت ۲.۲۲ به بالا)
git clone --filter=blob:none https://github.com/user/repo.git

# دریافت شاخه‌ای (فقط پوشه‌های خاص)
git sparse-checkout init
git sparse-checkout set folder1 folder2
```

### وضعیت سریع‌تر (Status)

```
# استفاده از کش برای فایل‌های ردیابی نشده
git config core.untrackedCache true

# استفاده از پایشگر فایل سیستم
git config core.fsmonitor true
```

## نکات امنیتی

### امضای GPG

```
# تولید کلید GPG
gpg --gen-key

# لیست کردن کلیدها
gpg --list-secret-keys --keyid-format LONG

# پیکربندی Git
git config --global user.signingkey <key-id>
git config --global commit.gpgsign true

# امضای کامیت‌ها
git commit -S -m "کامیت امضا شده"
```

### اطلاعات احراز هویت

```
# هرگز رمز عبور را در تنظیمات ذخیره نکنید
# از ابزارهای مدیریت اطلاعات کاربری (credential helpers) استفاده کنید

# استفاده از SSH برای احراز هویت (توصیه شده)
ssh-keygen -t ed25519 -C "email@example.com"

# استفاده از HTTPS همراه با توکن
# تولید Personal Access Token در GitHub
# استفاده از آن به جای رمز عبور
```

## تجربه نهایی

### چک‌لیست بهترین تجربه‌ها

- [ ] مکرراً کامیت کنید، مرتباً ارسال (push) کنید.
- [ ] پیام‌های کامیت معنادار بنویسید.
- [ ] کامیت‌ها را اتمی و متمرکز نگه دارید.
- [ ] برای هر قابلیت یا اصلاح باگ، شاخه بسازید.
- [ ] قبل از PR، کد خود را بازبینی کنید.
- [ ] قبل از Push، ابتدا Pull کنید.
- [ ] هرگز به شاخه‌های مشترک Force push نکنید.
- [ ] از .gitignore به درستی استفاده کنید.
- [ ] برای نسخه‌ها تگ (Tag) بزنید.
- [ ] گردش کار خود را مستند کنید.

### وقتی اوضاع بد پیش می‌رود

۱. **نترسید**: گیت به ندرت اطلاعات را واقعاً گم می‌کند.
۲. **Check reflog**: این توری نجات شماست.
۳. **بکاپ بگیرید**: قبل از آزمایش راه‌حل‌های پیچیده، یک شاخه بکاپ بسازید.
۴. **کمک بگیرید**: جامعه کاربری گیت بسیار یاری‌رسان است.
۵. **از اشتباهات درس بگیرید**: هر خطایی چیزی به شما می‌آموزد.

## تبریک می‌گویم!

شما ۳۰ روز تسلط بر Git را به پایان رساندید! شما یاد گرفتید:

* مبانی و معماری Git.
* استراتژی‌های شاخه‌بندی و ادغام.
* مدیریت تاریخچه (reset, rebase, amend).
* گردش‌های کاری ریموت و همکاری.
* گردش‌های کار GitHub و بهترین تجربه‌ها.
* نکات پیشرفته و عیب‌یابی.

### یادگیری را متمرکز ادامه دهید

* مرتباً تمرین کنید.
* در پروژه‌های متن‌باز مشارکت کنید.
* از تاریخچه گیت دیگران یاد بگیرید.
* قابلیت‌های پیشرفته را جستجو کنید.
* با نسخه‌های جدید گیت همگام باشید.

## سخن پایانی

گیت ابزار قدرتمندی است که هر چه بیشتر از آن استفاده کنید، ارزشمندتر می‌شود. سعی نکنید همه چیز را حفظ کنید - این راهنما را علامت‌گذاری (bookmark) کرده و در صورت نیاز به آن مراجعه کنید. مهم‌ترین چیز این است که به تمرین ادامه دهید و از تجربه کردن (در یک محیط امن) نترسید.

کدنویسی خوش بگذرد و امیدوارم ادغام‌های شما همیشه بدون تداخل باشد!

## لینک‌های مرجع

* [Pro Git Book](https://git-scm.com/book)
* [Git Documentation](https://git-scm.com/docs)
* [GitHub Guides](https://guides.github.com/)
* [Atlassian Git Tutorials](https://www.atlassian.com/git/tutorials)

---

* [بازگشت به فهرست مطالب](README.md)
* [روز قبل: نحوه وارد کردن پروژه‌های Subversion به مخزن Git](29.md)

---

## با تشکر!

از اینکه همراه این سفر ۳۰ روزه با گیت بودید، سپاسگزارم. تمرین را ادامه دهید، یاد بگیرید و به خاطر داشته باشید - هر متخصص گیتی، زمانی مبتدی بوده است!
